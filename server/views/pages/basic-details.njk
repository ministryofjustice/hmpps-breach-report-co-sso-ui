{% extends "../partials/layout.njk" %}

{% set pageTitle = applicationName + " - Basic Details" %}
{% set mainClasses = "app-container govuk-body" %}

{% block content %}

  {% from "moj/components/side-navigation/macro.njk" import mojSideNavigation %}
  {% from "govuk/components/phase-banner/macro.njk" import govukPhaseBanner %}
  {% from "govuk/components/input/macro.njk" import govukInput %}
  {% from "govuk/components/select/macro.njk" import govukSelect %}
  {% from "govuk/components/button/macro.njk" import govukButton %}
  {% from "moj/components/date-picker/macro.njk" import mojDatePicker %}
  {% from "govuk/components/radios/macro.njk" import govukRadios %}

  <form method="post">

    {% set errorList =[
      { text: errorMessages.genericErrorMessage.text, href: "#" } if errorMessages.genericErrorMessage else None
    ] | reject("undefined") %}

    {% if errorMessages | length > 0 %}
      {% from "govuk/components/error-summary/macro.njk" import govukErrorSummary %}
      {{ govukErrorSummary({ titleText: "There is a problem", errorList: errorList }) }}
    {% endif %}

    <input type="hidden" name="_csrf" value="{{ csrfToken }}">

    <div class="govuk-grid-row">
      <div class="govuk-grid-column-one-third">
        {% include "pages/side-nav.njk" %}
      </div>

      <div class="govuk-grid-column-two-thirds">

        {% if not showEmbeddedError %}

          <h1 id="page-title" class="govuk-heading-l">Breach Report CO SSO - Basic Details</h1>

          <h2 class="govuk-heading-m">Title and Full Name</h2>
          <p id="name">{{ titleAndFullName }}</p>

          <h2 class="govuk-heading-m">Date of Birth</h2>
          <p id="date-of-birth">{{ formattedDob }}</p>

          <h2 class="govuk-heading-m">CRN</h2>
          <p id="crn">{{ cosso.crn }}</p>

          <h2 class="govuk-heading-m">Main Address</h2>
          {% if defaultAddress %}
            <p id="address">
              {% if defaultAddress.buildingName %} {{ defaultAddress.buildingName }}
                <br/>{% endif %}
              {% if defaultAddress.buildingName or defaultAddress.streetName %} {{ defaultAddress.buildingNumber }} {{ defaultAddress.streetName }}
                <br/>{% endif %}
              {% if defaultAddress.district %} {{ defaultAddress.district }}
                <br/>{% endif %}
              {% if defaultAddress.townCity %} {{ defaultAddress.townCity }}
                <br/>{% endif %}
              {% if defaultAddress.county %} {{ defaultAddress.county }}
                <br/>{% endif %}
              {% if defaultAddress.postcode %} {{ defaultAddress.postcode }}
                <br/>{% endif %}
            </p>
          {% else %}
            <p id="no-address-found"> No Postal Address found in National Delius <br/>
              In order to complete a Breach Report CO SSO you must add an address to Delius <br/>
              Please use the below link to add an address <br/>
              <a href="{{ addAddressDeeplink }}" id="add-address--deeplink"
                 target="_blank" class="govuk-link">
                Click this hyperlink to open a new tab to add an address to Delius
              </a><br/>
              Once this is completed, click the Refresh from Delius button </p>
          {% endif %}

          <h2 class="govuk-heading-m">Phone Number</h2>
          <p id="phone-number">{{ telephoneNumber }}</p>

          <h2 class="govuk-heading-m">Mobile Number</h2>
          <p id="mobile-number">{{ mobileNumber }}</p>

          <h2 class="govuk-heading-m">Email Address</h2>
          <p id="email-address">{{ emailAddress }}</p>

          <div class="moj-button-group">
            {{ govukButton({
              text: "Continue",
              preventDoubleClick: "true",
              type: "submit",
              attributes: {
                id: "continue-button"
              }
            }) }}
            {{ govukButton({
              text: "Save Progress and Close",
              type: "submit",
              name: "action",
              value: "saveProgressAndClose",
              classes: "govuk-button--secondary",
              attributes: {
                id: "close-button"
              }
            }) }}
            {{ govukButton({
              text: "Refresh from Delius",
              preventDoubleClick: "true",
              type: "submit",
              name: "action",
              value: "refreshFromNdelius",
              classes: "govuk-button--secondary",
              attributes: {
                id: "refresh-from-ndelius--button"
              }
            }) }}
          </div>

        {% endif %}
      </div>
    </div>

  </form>
{% endblock %}
